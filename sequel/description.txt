Молекулы - прекрасные вещи. Особенно органические...


--------------------------------------------------------------------------------

Обзор
На этот раз вам будет предоставлено название молекулы в виде строки, 
и вы должны будете преобразовать его в соответствующую сырую формулу (в виде словаря/картинки).

Входные данные:

"5-methylhexan-2-ol"

    OH         CH3
    |          |        (изображение будет выведено в консоль)
CH3-CH-CH2-CH2-CH-CH3

Вывод:
ParseHer("5-methylhexan-2-ol").parse() == {'C':7, 'H': 16, 'O': 1}

--------------------------------------------------------------------------------

Для этого вам придется решить две задачи:

Найти способ правильно токенизировать и затем разобрать название молекулы, 
используя предоставленную информацию (вам придется узнать правильную грамматику, как это сделал я ;-p ).
Затем постройте полную исходную формулу и верните ее в виде словаря (ключ: химический символ в виде строки, значение: 
номер этого химического элемента в молекуле).

Все входные данные будут действительны.

--------------------------------------------------------------------------------

Чтобы помочь вам в решении этой задачи, мы предлагаем несколько вещей:

1.  Знания химии не требуются: всю необходимую информацию вы найдете ниже. 
(Примечание: да, она очень длинная, но большая часть необходимых строк уже приведена в настройках решения, 
используя различные списки. Используйте их по своему усмотрению )

2.  Для создания исходной формулы вам может помочь знание химии, но не волнуйтесь, 
если вы им не являетесь: вам просто нужно будет определить закономерности с помощью различных тестов.
Они специально разработаны так, чтобы эти закономерности можно было легко обнаружить. 
(Примечание: если вас это интересует, то соответствующие академические знания касаются "степени ненасыщенности" молекулы. 
Если вы уже знаете об этом, это, конечно, будет полезно, но если нет, просто сосредоточьтесь на работе по распознаванию образов, 
проходя тесты с примерами, а не пытайтесь разобраться в этом понятии с помощью статьи в Вики (которая довольно плоха в этом плане) ).

3.  Все молекулы будут отрисованы в консоли (кроме случайных тестов и самого последнего фиксированного теста), чтобы вы могли видеть, 
что это такое. (Примечание: из-за необходимости использования символов '' для обозначения некоторых границ, 
строки в примерах тестов могут быть не очень читабельными. Предпочтительнее смотреть на версию, выводимую в консоль )


Спецификации тестов:
40 пробных тестов
около 85 фиксированных тестов
5500 случайных тестов


--------------------------------------------------------------------------------

                        Правила номенклатуры органических соединений
                        (По крайней мере, некоторые из них...)


Вот что вам нужно знать о номенклатуре органических соединений.

Здесь вы получите очень много информации. Имейте в виду, что вы получите гораздо больше, 
чем нужно для решения задачи, чтобы быть уверенным, что вы сможете найти свой путь в названиях, если утверждение не сработает. 
Так что не стоит уклоняться только из-за этого... ;)

В конце описания вы найдете несколько кратких обзоров всей информации, которые помогут вам сориентироваться во всем этом.
И не забудьте прочитать самый последний раздел, хорошо названный "булавки в заднице", в самом низу описания._


Заметки для химиков или тех, кто беспокоится:

Названия, с которыми вы столкнетесь, всегда будут "хорошо сформированы", но не всегда будут "хорошими", особенно в случайных тестах. 
То есть, они всегда будут представлять реальную молекулу/разбираться по правилам ниже, 
но они могут не быть реальным названием этой молекулы (например: неправильный выбор главной цепи, инверсия нумерации позиций, ...). 
Те, кто немного разбирается в номенклатуре, могут их заметить. Для остальных - не заморачивайтесь, просто применяйте приведенные правила ;)

Чтобы облегчить задачу и иметь более последовательные строки для названий, 
позиции групп/рамификаций будут написаны по примеру французской номенклатуры, 
где позиция находится справа на... слева... XD соответствующей части. То есть, ожидайте "бутан-2-ол" вместо "2-бутанол", и так далее.


Алканы

· Линейные алканы

Название линейных молекул, как в примерах ниже, обозначается просто "радикалом", представляющим число углеродов, 
за которым следует суффикс -ane:

радикал + "ane"

methane = meth + ane = 1 углерод   ->  CH4
ethane  = eth + ane  = 2 углерода  ->  CH3-CH3
propane = ...                      ->  CH3-CH2-CH3
butane  = ...                      ->  CH3-CH2-CH2-CH3
...

Список RADICALS (до 19 углеводородов) вы найдете внутри решения.


· Разветвленные алканы

Если молекула не является линейной, вы можете назвать ее, выбрав основную цепь, а затем добавить алкильные группы в начале названия. 
Вам не нужно беспокоиться о том, как выбирается основная цепь или как ведется нумерация.

Алкильные группы определяются следующим образом:

позиции + "-" + множитель + радикал + "yl" (где позиции - это числа, соединенные запятыми; множители объясняются сразу после)

CH3-CH-CH2-CH3    -> основная цепь: "butane" - бутан
    |
    CH3           -> алкил: "methane", на 2-ом углероде (в главной цепи) => "2-methyl"
                             (нет множителя, так как у вас только одна метильная группа)
    => 2-methylbutane


· Несколько разветвлении: мультипликаторы

Когда одна и та же алкильная группа находится в разных местах несколько раз, это добавляет множитель:

CH3-CH-CH-CH2-CH-CH3    => 2,3,5-trimethylhexane
    |  |      |                  ^^^
  CH3  CH3    CH3

CH3-CH-CH-CH2-CH-CH3    => 3-ethyl-2,5-dimethylhexane
    |  |      |                        ^^
  CH3  CH2    CH3
       |
       CH3


Вам не нужно знать о порядке следования алкилов в названии.
Вот полный список множителей (от 2 до 19, приведенный в настройке решения):

MULTIPLIERS = [         "di",     "tri",     "tetra",     "penta",     "hexa",     "hepta",     "octa",     "nona",     "deca", 
              "undeca", "dodeca", "trideca", "tetradeca", "pentadeca", "hexadeca", "heptadeca", "octadeca", "nonadeca"]



Циклы

Когда цепь или группа имеет циклическую форму, вы просто добавляете префикс цикло перед радикальной частью 
(как для основной цепи, так и для алкилов):

CH2-CH2
|   |                                => cyclobutane
CH2-CH2

CH3-CH-CH2-CH2-CH2-CH2-CH-CH3
    |                  |
    CH                 CH           => 2,7-dicyclobutyloctane
   / \                / \                    ^^^^^
H2C   CH2          H2C   CH2
   \ /                \ /
    CH2                CH2


Префикс "цикло" рассматривается как часть радикала, к которому он "применяется". 
Таким образом, в случае с разветвлениями порядок различных частей названия таков:

CH2-CH-CH2-CH3                 Основная цепь - циклическая:
|   |                                => 1-ethylcyclobutane
CH2-CH2                                        ^^^^^



Алкены и алкины

алкен: двойная связь между углеродами. Замените суффикс ane на "-" + позиции + "-" + множитель + "ene" 
(указывается только позиция первого углерода, имеющего двойную связь)

алкин: тройная связь между углеродами. Замените суффикс ane на "-" + позиции + "-" + множитель + "yne" 
(указывается только положение первого углерода, имеющего тройную связь).

Если в молекуле есть и алкены, и алкины, замените ane на ...en...yne (двойные связи всегда стоят на первом месте).


CH3-CH=CH-CH2-CH2-CH3    =>  hex-2-ene
CH3-CH=CH-CH2-CH=CH2     =>  hex-1,4-diene (внимание: нумерация изменена на противоположную, здесь)

CH3-C{=}C-CH2-CH2-CH3    =>  hex-2-yne  ('{=}' обозначает тройную связь)


Вы можете смешивать вещи...:

CH3-C{=}C-CH=CH-C{=}C-C{=}C-CH=CH-CH2-CH3

    => tridec-4,10-dien-2,6,8-triyne


...или даже найти их в алкильных группах:

CH3-C{=}C-CH-C{=}C-CH2-CH2-CH=CH-CH3    ->  основная цепь
          |
          CH2-CH=CH-CH=CH-CH2-CH3       ->  разветвление (примечание: позиция 1 - это всегда C, связанный с основной цепью)

    => 4-hept-2,4-dienylundec-9-en-2,5-diyne


Разветвление разветвлений

А вот и "веселая" работа... Если разветвление само разветвляется, то применяются те же правила, что и выше. 
Но для идентификации нижнего уровня используются квадратные скобки вокруг префикса нижнего уровня, 
причем эта часть ставится непосредственно перед радикальной частью алкильной группы на текущем уровне...

Пример может быть лучше:

позиции + "-" + множитель + "[" + субрамификация + "]" + радикал + "yl"

Примеры:

Без подразветвлении:

    CH2-CH-CH2-CH2-CH2-CH2-CH2-CH2-CH3     => 1-heptylcyclobutane
    |   |
    CH2-CH2

С подразветвлением:

                   CH2-CH2-CH3
                   |
    CH2-CH-CH2-CH2-CH-CH2-CH2-CH2-CH3      => 1-[3-propyl]heptylcyclobutane
    |   |
    CH2-CH2
    
                   CH2-CH2-CH3
                   |
    CH2-CH-CH2-CH2-CH-CH2-CH2-CH2-CH3
    |   |                                  => 1,2-di[3-propyl]heptylcyclobutane
    CH2-CH-CH2-CH2-CH-CH2-CH2-CH2-CH3
                   |                          (Примечание: "1,2-ди" относится ко всей части "[3-пропил]гептила")
                   CH2-CH2-CH3


Это происходит рекурсивно на любой глубине:

           CH3        CH3
           |          |
           CH2    CH2-CH-CH3
           |      |
    CH2-CH-CH-CH2-CH-CH2-CH2-CH2-CH3
    |   |                                  => 1,2-di[1-ethyl-3-[2-methyl]propyl]heptylcyclobutane
    CH2-CH-CH-CH2-CH-CH2-CH2-CH2-CH3
           |      |
           CH2    CH2-CH-CH3
           |          |
           CH3        CH3



Функции

Кроме того, в молекуле могут присутствовать "функциональные группы". Например, спирты, эфиры, карбоновые кислоты и так далее.
В принципе, эти функциональные группы можно найти в двух разных местах:

    · В самом конце имени, в качестве суффикса: Тогда это называется "главная функция". 
    Окончание e в имени заменяется на соответствующие позиции + "-" + множитель + суффикс, соответствующий функции.
    
    · Среди префиксов связанной углеродной цепи: Она ведет себя так же, как и алкильные группы: позиции + "-" + множитель + префикс, 
    за исключением того, что большинство этих функциональных групп не могут иметь подразветвлений 
    (как правило... есть некоторые исключения, см. подробности ниже).


Обратите внимание, что для одного и того же типа функциональной группы префикс(ы) и суффикс(ы) называются по-разному 
(причина этих двух названий в том, что только один тип функции может быть использован в качестве суффикса 
(мы не будем объяснять, как и почему), поэтому все остальные в молекуле должны отображаться как префиксы).

Ниже вы можете найти информацию обо всех функциональных группах, используемых в ката.


Простые функции

Галогены: всегда используются в качестве префиксов.

 F   ->   prefix = "fluoro"
  Cl  ->   prefix = "chloro"
  Br  ->   prefix = "bromo"
  I   ->   prefix = "iodo"
  
  CH3-CH2-CH2-CH2-CH2-F      ->     "1-fluoropentane"
  
  CH3-CH-CH2-CH2-CH3         ->     "2-chloropentane"
      |
      Cl
  
  CH3-CH-CH2-CH2-CHBr2        ->     "1,1-dibromo-4-chloropentane"
      |
      Cl


Спирты:

 OH  ->   prefix = "hydroxy"
           suffix = "ol"
  
      OH
      |
  CH3-CH-CH2-CH2-CH3         ->     "pentan-2-ol"
  
     HO  CH2-OH
      |  |
  CH3-CH-CH-CH2-CH2-OH       ->     "3-[1-hydroxy]methylpentan-1,4-diol"


Тиолы:

 SH   ->   prefix = "mercapto"
            suffix = "thiol"
  
      SH
      |
  CH3-CH-CH2-CH2-CH3         ->     "pentan-2-thiol"
  
     HO  CH2-CH2-SH
      |  |
  CH3-CH-CH-CH2-CH2-OH       ->     "3-[2-mercapto]ethylpentan-1,4-diol"


Имины:

  =NH  ->   prefix = "imino"
            suffix = "imine"
  
  H3C-CH2-CH2-C-CH3
              ||          ->     "pentan-2-imine"
              NH
              
          OH
          |
  H3C-CH2-CH-C-CH3
             ||          ->     "2-iminopentan-3-ol"
             NH

(Примечание: в этом ката азот имина никогда не будет удерживать карбоновую цепь, даже если это возможно.)



Немного менее простые функции

    · Кетоны: Они никогда не могут находиться на крайних звеньях цепи.

  =O    ->    prefix = "oxo"
              suffix = "one"
  
      O
      ||                ->    "pentan-2-one"
  CH3-C-CH2-CH2-CH3
  
            CH3
            |
  H3C   CH2-C=O         ->     "4-[1-oxo]ethylheptan-2,6-dione"
     \  |                      
      C-CH-CH2-C-CH3           (note that the ethyl ramification is the 
    //         ||               chain of 2 carbons on the very left, here)
   O           O


    
    · Альдегиды: Как и кетоны, но присутствуют только на крайних позициях.

Альдегиды немного особенные по двум пунктам:

Их префикс: до сих пор префиксы и суффиксы всегда обозначали одно и то же. 
Для альдегидов префикс представляет ту же самую функциональную группу, но с дополнительным углеродом и водородом. 
Смотрите примеры ниже.

Поскольку они всегда находятся на конце, при использовании суффиксов не нужно указывать их позицию 
(можно рассматривать это как элизию: см. последнюю часть описания). 
В префиксном варианте это все равно необходимо, поскольку "углерод на конце" уже находится в формильной группе, а значит, 
может быть в любом месте молекулы.

  -CH=O   ->    prefix = "formyl"  (в любом месте цепи)
     =O   ->    suffix = "al"      (как кетоны, но только в крайних случаях.)
  
  
      CH3-CH2-CH2-CH2-CH=O      ->     "pentanal"
  
             CH2-CH2-CH=O
             |                      
      HC-CH2-CH-CH2-CH2-CH=O    ->     "4-[1-formyl]methylheptandial"
     //
    O
          Обратите внимание на последний пример:
            - Разветвление по-прежнему является самой левой частью (O=CH-CH2-...),
              но так как формильная группа удерживает последний углерод, радикал
              используемый для разветвления, имеет только 1 углерод и является "метилом".
            - Позиционная информация для суффиксов отсутствует, но присутствует для 
              префикса, если нет элизии (см. предыдущий раздел).


    · Карбоновые кислоты: Они ведут себя примерно так же, как и альдегиды, имея префикс и суффикс, 
    обозначающие одну и ту же функциональную группу, но в некоторых случаях с 1 дополнительным углеродом. 
    При использовании суффиксов позиции обычно опускаются (как и в случае с альдегидами).

 Суффикс типа 1: "oic acid" (обратите внимание на наличие пробела).
  
       OH                          OH                 "ethanoic acid" 
       |          пример:          |                  (углерод функции находится в основной цепи)
  ...-(C)=O                    H3C-C=O
  
  
  
  Суффикс типа 2: "карбоновая кислота" (используется в некоторых особых случаях. Не заморачивайтесь с тем, как и почему)
  
      OH                           OH             ->  "methancarboxylic acid" 
      |           пример:          |                   ^^^^
  ...-C=O                      H3C-C=O               (что неверно, но покажет, что
                                                     углерод функции не рассматривается 
                                                     как часть основной цепи, здесь) 
                                            
  Префикс:         "carboxy"               OH
                                           |      ->  "4-carboxyheptan-1,7-dioic acid"
      OH                           CH2-CH2-C=O
      |           пример:          |                 (на этот раз, давайте сделаем это с помощью позиций... ;) )
  ...-C=O                     HO-C-CH-CH2-CH2-C=O 
                                //            |
                               O              OH


    · Амиды:

Для амидов мы будем использовать только простые случаи: их атом азота никогда не будет удерживать карбоновую цепь.
Амиды всегда находятся на конце цепи.

       NH2        Suffix:   "amide"
       |          Prefix:   "amido"
  ...-(C)=O


    H2N-CH=O                ->    "methanamide"
    
    O=C-CH2-CH=CH-CH3       ->    "pent-3-enamide"
      |
      NH2
      
    O=C-CH2-CH2-CH2-C=O     ->    "5-amidopentanoic acid"
      |             | 
      NH2           OH
    
Обратите внимание, что углерод не является частью функции, но является частью радикала.


Сложные случаи

Следующие случаи требуют вспомогательных цепочек или ведут себя странно.

Амины, фосфины, арсины:
Эти три случая имеют одинаковое поведение и сильную специфику: 
они могут использоваться с двумя разными видами номенклатуры и могут содержать ноль или более карбоновых цепей. 
Давайте рассмотрим это подробнее...

В качестве суффиксов:  "amine", "phosphine", "arsine".
  · СПОСОБ 1: Сама функция рассматривается как основная цепь, а все карбоновые цепи (до трех) вокруг являются алкилами.
  --------
  · СПОСОБ 2: Не является общим случаем, но может использоваться так же, как и предыдущие функции.
  --------    

Примеры:                 СПОСОБ 1                     СПОСОБ 2
    
    H3C-NH2           "methylamine"                "methan-1-amine"
    H3C-PH2           "methylphosphine"            "methan-1-phosphine"
    H3C-AsH2          "methylarsine"               "methan-1-arsine"
    
    H3C-N-CH2-CH3     "ethyldimethylamine"         "ethan-1-[dimethyl]amine"
        |                                            
        CH3


СПОСОБ 2 используется конкретно для таких случаев: 

    H2N-H2C-CH2-CH2-CH2-CH2-CH2-NH2        hexan-1,6-diamine
    
Префиксы, с другой стороны, ведут себя «обычным» образом, за исключением того, что функции могут содержать подразветвления.

Префиксы:    "amino", "phosphino", "arsino"

                OH
                |                            ->    "1,6-diaminohexan-3-ol"
    H2N-H2C-CH2-CH-CH2-CH2-CH2-NH2 

                OH
                |                            ->    "1-amino-6-[diethyl]arsinohexan-3-ol" 
    H2N-H2C-CH2-CH-CH2-CH2-CH2-As-CH2-CH3
                               |                  (нет позиции для этиловых групп поскольку они
                               CH2-CH3             связаны с атомом мышьяка, а не с цепочкой.)

Эфиры:
У них много общего с предыдущими, но в суффиксе присутствует только «способ 1». 
Итак, нет основной цепи, и (всегда) два алкила, поскольку эфиры производятся с кислородом.

Суффикс:    "alkylether"
  
Примеры:      H3C-CH2-O-CH2-CH3         "diethylether"
               
               H3C-O-CH=CH-CH3           "methylprop-1-enylether"
               

Префикс:    "alkoxy"

Примеры:      H3C-O-CH2-CH2-CH2-OH      "3-methoxypropan-1-ol"
               ^^^^^                        ^^^^^^^
               
    Обратите внимание, что радикал используется в «сыром» виде. 
    Хотя, если множественная связь была во вспомогательной цепочке:
    
        H2C=CH-CH2-O-CH2-CH2-CH2-OH      "3-prop-2-enoxypropan-1-ol"

Эстеры:
Они нуждаются во вспомогательной карбоновой цепи (алкиловой). Их общая форма в качестве суффикса такова:

Suffix: alkyl alkanoate

       O
       ||         Основная цепь, как «алкан»: та, что начинается с «(C)», между двумя оксигенами.
  ...-(C)-O-R     Вспомогательная цепь, как у «алкила»: «R», отделенная от основной цепи кислородом.

Note that:

Углерод основной цепи является частью основной цепи, а не функцией.
Здесь вам снова придется иметь дело с двумя разделенными словами.
Примеры:

      O 
      ||                                ->   "propyl ethanoate"
  CH3-C-O-CH2-CH2-CH3
  
        O 
       ||                               ->   "methyl butanoate"
  CH3-O-C-CH2-CH2-CH3
  
                        O
                        ||              ->   "eth-1-enyl hept-2-enoate"
  CH3-CH2-CH2-CH2-CH=CH-C-O-CH=CH2
Благодаря своей структуре, эфиры как приставки могут быть в двух разных формах:

Префикс 1-го типа: alkoxycarbonyl

      O 
      ||         Основная цепь, как «...»: углерод функции НЕ является частью основной цепи.
  ...-C-O-R      Вспомогательная цепь, как «алк»: «R», разделенный кислородом.

Пример:
             CH3                                vvvvvvvvvvvvvv
 vvvvvvvvvvv |                          ->   "4-ethoxycarbonylpentanoic acid"
 CH3-CH2-O-C-CH-CH2-CH2-C=O
          ||            |                     (обратите внимание на отсутствие квадратных скобок.
           O            OH                     и отсутствие «yl» во вспомогательной цепочке.)

Префикс 2-го типа: alkanoyloxy...

         O
        ||        Основная цепочка, как «...».
  ...-O-(C)-R     Вспомогательная цепь, как «алкан»: «R», С углеродом между двумя оксигенами.

Пример:
             CH3                                vvvvvvvvvvvv
 vvvvvvvvvvv |                          ->   "4-propanoyloxypentanoic acid"
 CH3-CH2-C-O-CH-CH2-CH2-C=O                    
        ||              |
         O              OH                    (обратите внимание на отсутствие квадратных скобок, снова)
         
  Поместите двойную связь во вспомогательную цепочку, и с этим префиксом она станет ""prop-2-enoyloxy..."


Ароматические циклы:
На самом деле это особый вид радикалов. Мы сосредоточим наши усилия только на одном простом случае - бензоле.

· Используется в качестве основной цепи: «benzol», C6Hx (основа: C6H6, меньше H, если замещен)

        HC-CH
       //   \\
      HC     CH        Конечно, он может иметь свои последствия и функции.
        \   /
        HC=CH
        
             CH2-CH3
            /
        HC-C
       //   \\
      HC     C-CH=O     ->    "2-ethyl-1-formylbenzene"
        \   /
        HC=CH


· Используется как разветвление:    «phenyl», C6H5

        HC-CH                  OH
       //   \\                 | 
      HC     C-CH2-CH2-CH2-CH2-C=O      ->   "5-phenylpentanoic acid"
        \   /
        HC=CH

Для химиков: чтобы упростить ситуацию, мы не будем рассматривать такие случаи, как фенол, бензоил, ... 
Фенол, если он возникнет, будет называться «бензол», и так далее.



Резюме

Общая форма названия
Итак, из некоторых исключений название органического соединения можно представить примерно так:

[[...]подпарты]префиксы + радикал + суффиксы

С использованием:
  суффиксы = алкены, алкины, функциональные группы
  префиксы = функциональные группы (как префиксы), субцепи, «цикло»
  
  подцепи = [другие префиксы] + (цикло) + радикал + (алкены или алкины) + «yl»
            или функциональные группы в качестве префиксов
  подчасти = подцепи

Примечание: это НЕ надежная BNF-диаграмма, а лишь некий помощник, вокруг которого, я надеюсь, вы сможете собрать свои мысли.


Радикалы и мультипликаторы
 Номер     Радикал     Множитель
------     -------     ----------
   #1       meth        /
   #2       eth         di
   #3       prop        tri
   #4       but         tetra
   #6       pent        penta
   #6       hex         hexa
   #7       hept        hepta
   #8       oct         octa
   #9       non         nona
   #10      dec         deca
   #11      undec       undeca
   #12      dodec       dodeca
   #13      tridec      trideca
   #14      tetradec    tetradeca
   #15      pentadec    pentadeca
   #16      hexadec     hexadeca
   #17      heptadec    heptadeca
   #18      octadec     octadeca
   #19      nonadec     nonadeca

Разное
Алканы -ane
Алкены -ene
Алкины -yne
Алкилы -yl
Циклы -cyclo

Функциональные группы
Примечание к представлениям «Химические группы»:
    · Когда вы видите «(C)», это означает, что углерод уже учтен в основной цепи:
      вам не нужно добавлять новый, чтобы построить функцию.
    · Внимание при изображении карбоновых кислот, амидов и эфиров: 
      помните о двойной связи с одним из «O» (см. подробности вверху).
    

Функциональная группа      Префикс             Суффикс             Химическая группа      Примечания
---------------------      -------             ------              -----------------      ----------

Галогены                    fluoro              .                   ...-F
                            chloro              .                   ...-Cl
                            bromo               .                   ...-Br
                            iodo                .                   ...-I

Спирты                      hydroxy             ol                  ...-OH

Тиолы                       mercapto            thiol               ...-SH

Кетоны                      oxo                 one                 ...(C)=O            Никогда не находитесь в конце цепи
Альдегиды                   .                   al                  ...(C)H=O           Только в конце основной цепи
                            formyl              .                   ...CH=O             1 дополнительный карбон!

Карбоновые кислоты          .                   oic acid            ...(C)O-OH          Только в конце основной цепи
                            .                   carboxylic acid     ...-CO-OH           1 дополнительный карбон!
                            carboxy             .                   ...-CO-OH           1 дополнительный карбон!

Эстеры                      .                   (alkyl) ...oate     ...(C)O-O-R         R представляет собой вторичную алкильную цепь (см. подробности выше). 
                                                                                        Только на конце основной цепи
                           (alk)oxycarbonyl     .                   ...(C)-CO-O-R       В любом месте цепи. R - вторичная алкильная цепь (см. подробности выше)
                           (alkan)oyloxy        .                   ...(C)-O-OR         В любом месте цепи. R - вторичная алкильная цепь (см. подробности выше)
                      
Эфиры                      (alk)oxy             (alkyles)ether      R1-O-R2             R1 и R2 - алкилы, если суффикс, или R2 - основная цепь, если префикс (см. подробности выше).

Амины                      (alkyles)amino       amine               N  (various)        Подробнее о различных возможностях см. выше
Амиды                       amido               amide               ...(C)O-NH2         Только в крайнем случае
Имины                       imino               imine               ...(C)=NH

Арсины                     (alkyles)arsino      (alkyles)arsine     As (various)        Подробнее о различных возможностях см. выше
Фосфины                    (alkyles)phosphino   (alkyles)phosphine  P  (various)        Подробнее о различных возможностях см. выше

Ароматические циклы         .                   benzene             C6Hx (various)      Подробнее о различных возможностях см. выше
                            phenyl              .                   ...-C6H5

Валентное число всех участвующих атомов
Валентное число - это количество связей (понимаемых как число штрихов, отходящих от атома), 
которые данный химический элемент образует с другими атомами.
 В любой молекуле любой атом должен иметь именно это число.

  1  |  2  |  3  |  4
-----|-----|-----|-----
  Br |  O  |  As |  C  
  Cl |  S  |  N  |     
  F  |     |  P  |     
  H  |     |     |     
  I  |     |     |     


Раздел «Подводные камни»

Исключения из некоторых положений
Химики - явно не компьютерщики (или, по крайней мере, те, кто устанавливал правила номенклатуры).
Это значит, часто случается, что они убирают какие-то крошечные части названия, 
если считают их бессмысленными или громоздкими, или даже добавляют какие-то, если считают, что так красивее или звучащее.
Для нашей же пользы мы рассмотрим только один из этих случаев: 
элиминацию позиций групп или функций на первом углероде цепи (но присутствующих исключительно в этой позиции):

"cyclobutan-1-ol"        =>   "cyclobutanol"
"cyclobutan-1,1-diol"    =>   "cyclobutandiol"

"cyclobutan-1,2-diol"    =>   "cyclobutan-1,2-diol"  (без элизии, потому что не только «один(а)»)
Обратите внимание, что элизия не является систематической, поэтому вашему коду придется работать в обоих случаях.
Элизия, конечно, может быть применена к любой части имени, которая требует номера позиции, как, например, в «chlorocyclobutane».

Неоднозначные совпадения при разборе названия молекулы
Если вы столкнулись с неоднозначными случаями, которые не поддаются четкой идентификации, предположите, 
что вы получите самое длинное из возможных имен цепочек. Но ТОЛЬКО в том случае, если совпадение неоднозначно!
Некоторые примеры:

"2,3,5-tridecyl"  =>   НЕ двусмысленно: это три цепочки «децил».
"2-tridecyl"      =>   НЕ двусмысленно: это один «тридецил» в положении 2
"tridecylamine"   =>   Неясно, потому что функция амина может содержать до 3 цепей, поэтому предположим, что это одна «тридециловая» цепь